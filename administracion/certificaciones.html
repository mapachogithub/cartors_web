<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="certificaciones.css">
    <title>Certificaciones emitidas</title>
</head>
<body>
    <header>
        <div class="header-container">
            <h1>Panel de Administración</h1>
            <nav>
                <ul>
                    <li><a href="admin.html">Inicio</a></li>
                    <li><a href="nuestros_clientes.html">Inventario de Clientes</a></li>
                    <li><a href="nuestros_empleados.html">Nuestros Empleados</a></li>
                    <li><a href="certificaciones.html">Certificaciones</a></li>
                    <li><a href="certificaciones_pendientes.html">Certificaciones por emitir</a></li>
                    <li><a href="facturas.html">Facturas</a></li>
                    <li><a href="../index.html">Cerrar Sesión</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="centrado">
            <h2>Listado de Empresas Certificadas</h2>
            <p>Aquí se muestra el registro de las empresas certificadas con sus detalles y opciones de gestión.</p>

            <div class="formulario-nueva-certificacion">
                <h3>Añadir Nueva Certificación</h3>
                <form id="nuevaCertificacionForm">
                    <div class="form-row">
                        <label for="empresa">Empresa:</label>
                        <input type="text" id="empresa" name="empresa" required>
                    </div>
                    <div class="form-row">
                        <label for="certificada">¿Certificada?</label>
                        <select id="certificada" name="certificada">
                            <option value="Sí">Sí</option>
                            <option value="No">No</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label for="motivo">Motivo:</label>
                        <input type="text" id="motivo" name="motivo">
                    </div>
                    <div class="form-row">
                        <label for="observaciones">Observaciones:</label>
                        <input type="text" id="observaciones" name="observaciones">
                    </div>
                    <div class="form-row">
                        <label for="archivo">Subir Certificación (PDF):</label>
                        <input type="file" accept=".pdf" id="archivo" name="archivo">
                    </div>
                    <div class="form-row">
                        <label for="correo">Enviar al Correo:</label>
                        <input type="email" id="correo" name="correo" placeholder="correo@empresa.com">
                    </div>
                    <button type="button" onclick="agregarCertificacion()">Añadir Certificación</button>
                </form>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Empresa</th>
                        <th>¿Certificada?</th>
                        <th>Motivo</th>
                        <th>Observaciones</th>
                        <th>Subir Certificación (PDF)</th>
                        <th>Enviar al Correo</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="tablaCertificacionesBody">
                    <tr>
                        <td data-label="Empresa">Tech Solutions</td>
                        <td data-label="¿Certificada?">
                            <select name="certified_techsolutions">
                                <option value="Sí" selected>Sí</option>
                                <option value="No">No</option>
                            </select>
                        </td>
                        <td data-label="Motivo">Cumplimiento de normas ISO 9001</td>
                        <td data-label="Observaciones">Revisión anual completada.</td>
                        <td data-label="Subir Certificación (PDF)">
                            <input type="file" accept=".pdf" name="cert_techsolutions">
                        </td>
                        <td data-label="Enviar al Correo">
                            <input type="email" placeholder="correo@empresa.com" name="email_techsolutions">
                            <button>Enviar</button>
                        </td>
                        <td data-label="Acciones"><button class="eliminar-btn" onclick="eliminarFila(this)">Eliminar</button></td>
                    </tr>
                    <tr>
                        <td data-label="Empresa">Eco Energy</td>
                        <td data-label="¿Certificada?">
                            <select name="certified_ecoenergy">
                                <option value="Sí">Sí</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                        <td data-label="Motivo">Falta de documentación</td>
                        <td data-label="Observaciones">Pendiente de auditoría.</td>
                        <td data-label="Subir Certificación (PDF)">
                            <input type="file" accept=".pdf" name="cert_ecoenergy">
                        </td>
                        <td data-label="Enviar al Correo">
                            <input type="email" placeholder="correo@empresa.com" name="email_ecoenergy">
                            <button>Enviar</button>
                        </td>
                        <td data-label="Acciones"><button class="eliminar-btn" onclick="eliminarFila(this)">Eliminar</button></td>
                    </tr>
                    <tr>
                        <td data-label="Empresa">Global Logistics</td>
                        <td data-label="¿Certificada?">
                            <select name="certified_globallogistics">
                                <option value="Sí" selected>Sí</option>
                                <option value="No">No</option>
                            </select>
                        </td>
                        <td data-label="Motivo">Certificación ambiental aprobada</td>
                        <td data-label="Observaciones">Válida hasta 2026.</td>
                        <td data-label="Subir Certificación (PDF)">
                            <input type="file" accept=".pdf" name="cert_globallogistics">
                        </td>
                        <td data-label="Enviar al Correo">
                            <input type="email" placeholder="correo@empresa.com" name="email_globallogistics">
                            <button>Enviar</button>
                        </td>
                        <td data-label="Acciones"><button class="eliminar-btn" onclick="eliminarFila(this)">Eliminar</button></td>
                    </tr>
                </tbody>
            </table>
        </section>
    </main>

    <footer>
        <p>© 2025 Cartor's SAS.</p>
        <p>Todos los derechos reservados.</p>
        <br>
        <p>Codificación y edición:</p>
        <p>Francisco Quiñones Maldonado</p>
        <p>Soluciones Tecnológicas</p>
    </footer>

    <script>
        function agregarCertificacion() {
            const form = document.getElementById('nuevaCertificacionForm');
            const tablaBody = document.getElementById('tablaCertificacionesBody');

            const empresa = form.empresa.value;
            const certificada = form.certificada.value;
            const motivo = form.motivo.value;
            const observaciones = form.observaciones.value;
            const archivo = form.archivo.value; // Solo el nombre del archivo
            const correo = form.correo.value;

            if (empresa && certificada) {
                const nuevaFila = tablaBody.insertRow();

                let celda = nuevaFila.insertCell();
                celda.textContent = empresa;
                celda.dataset.label = 'Empresa';

                celda = nuevaFila.insertCell();
                celda.textContent = certificada;
                celda.dataset.label = '¿Certificada?';

                celda = nuevaFila.insertCell();
                celda.textContent = motivo;
                celda.dataset.label = 'Motivo';

                celda = nuevaFila.insertCell();
                celda.textContent = observaciones;
                celda.dataset.label = 'Observaciones';

                celda = nuevaFila.insertCell();
                const inputFile = document.createElement('input');
                inputFile.type = 'file';
                inputFile.accept = '.pdf';
                inputFile.name = `cert_${empresa.toLowerCase().replace(/\s/g, '')}`;
                celda.appendChild(inputFile);
                celda.dataset.label = 'Subir Certificación (PDF)';

                celda = nuevaFila.insertCell();
                const emailInput = document.createElement('input');
                emailInput.type = 'email';
                emailInput.placeholder = 'correo@empresa.com';
                emailInput.name = `email_${empresa.toLowerCase().replace(/\s/g, '')}`;
                emailInput.value = correo;
                const enviarButton = document.createElement('button');
                enviarButton.textContent = 'Enviar';
                celda.appendChild(emailInput);
                celda.appendChild(enviarButton);
                celda.dataset.label = 'Enviar al Correo';

                // Nueva celda para el botón Eliminar
                celda = nuevaFila.insertCell();
                const eliminarButton = document.createElement('button');
                eliminarButton.textContent = 'Eliminar';
                eliminarButton.classList.add('eliminar-btn');
                eliminarButton.onclick = function() {
                    eliminarFila(this);
                };
                celda.appendChild(eliminarButton);
                celda.dataset.label = 'Acciones';

                form.reset(); // Limpiar el formulario después de añadir
            } else {
                alert('Los campos Empresa y ¿Certificada? son obligatorios.');
            }
        }

        function eliminarFila(boton) {
            const fila = boton.parentNode.parentNode; // Obtiene la fila (<tr>) del botón
            fila.remove(); // Elimina la fila de la tabla
        }
    </script>
</body>
</html>